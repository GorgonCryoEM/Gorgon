#include <boost/python.hpp>

#include "SkeletonMaker/volume.h"
#include "MeshRenderer.h"
#include "ProteinMorph/SSEHunter.h"
#include <MathTools/Vector3D.h>
#include "CAlphaRenderer.h"

using namespace SkeletonMaker;
using namespace Protein_Morph;

using namespace boost::python;

BOOST_PYTHON_MODULE(@current_pylib@)
{
  class_<Volume>("Volume", init<>())
      .def("getOriginX", &Volume::getOriginX)
      .def("getOriginY", &Volume::getOriginY)
      .def("getOriginZ", &Volume::getOriginZ)
      .def("getSizeX", &Volume::getSizeX)
      .def("getSizeY", &Volume::getSizeY)
      .def("getSizeZ", &Volume::getSizeZ)
      .def("getSize", &Volume::getSize)
      .def("getSize", &Volume::cmp)
      .def("getSpacingX", &Volume::getSpacingX)
      .def("getSpacingY", &Volume::getSpacingY)
      .def("getSpacingZ", &Volume::getSpacingZ)
//      .def("getMin", &Volume::getMin)
//      .def("getMax", &Volume::getMax)
//      .def("getDataAt", getDataAt1)
//      .def("buildHistogram", &Volume::buildHistogram)
//      .def("getHistogramBinValue", &Volume::getHistogramBinValue)
//
      .def("normalizeVolume", &Volume::normalizeVolume)
//        .def("downsampleVolume", &Volume::DownsampleVolume)
//        .def("cropVolume", &Volume::CropVolume)
      .def("performBinarySkeletonizationJu2007", &Volume::PerformBinarySkeletonizationJu2007, return_value_policy<reference_existing_object>())
      .def("performGrayscaleSkeletonizationAbeysinghe2008", &Volume::PerformGrayscaleSkeletonizationAbeysinghe2008, return_value_policy<reference_existing_object>())     
//        .def("performPreservingGrayscaleSkeletonizationAbeysinghe2008", &Volume::PerformPreservingGrayscaleSkeletonizationAbeysinghe2008, return_value_policy<reference_existing_object>())     
      .def("getMinDensity", &Volume::getMinDensity)
      .def("getMaxDensity", &Volume::getMaxDensity)
      .def("setVolume", &Volume::setVolume)
      .def("getVolume", &Volume::getVolume, return_value_policy<reference_existing_object>())      
//      .def("saveFile", &Volume::SaveFile)
      .def("loadFile", &Volume::loadFile)
      .def("saveFile", &Volume::saveFile)

  ;

  class_<NonManifoldMesh_Annotated, bases<Volume> >("NonManifoldMesh_Annotated", init<>())
  ;
  
  class_< MeshRenderer, bases<Volume> >("MeshRenderer", init<>())
//      .def("draw", &MeshRenderer::Draw)
//      .def("drawBoundingBox", &MeshRenderer::DrawBoundingBox)
      .def("loadFile", &MeshRenderer::loadFile)
//      .def("loadVolume", &MeshRenderer::LoadVolume)
//      .def("saveFile", &MeshRenderer::SaveFile)
//      .def("unload", &MeshRenderer::Unload)
//      .def("selectionRotate", &MeshRenderer::SelectionRotate)
//      .def("selectionObjectCount", &MeshRenderer::SelectionObjectCount)
//      .def("selectionCenterOfMass", &MeshRenderer::SelectionCenterOfMass)
//      .def("selectionMove", &MeshRenderer::SelectionMove)
//      .def("selectionClear", &MeshRenderer::SelectionClear)       
//      .def("selectionToggle", &MeshRenderer::SelectionToggle) 
//      .def("performSmoothLaplacian", &MeshRenderer::PerformSmoothLaplacian)
//      .def("getSupportedLoadFileFormats", &MeshRenderer::GetSupportedLoadFileFormats)
//      .def("getSupportedSaveFileFormats", &MeshRenderer::GetSupportedSaveFileFormats)
//      .def("getMin", &MeshRenderer::GetMin)
//      .def("getMax", &MeshRenderer::GetMax)
      .def("getMesh", &MeshRenderer::getMesh, return_value_policy<reference_existing_object>())
//      .def("get3DCoordinates", &MeshRenderer::Get3DCoordinates)
//      .def("intersectMeshAndSphere", &MeshRenderer::IntersectMeshAndSphere)
//      .def("getIntersectionPoint", &MeshRenderer::GetIntersectionPoint)
//      .def("setLineThickness", &MeshRenderer::SetLineThickness)
//      .def("setSpacing", &MeshRenderer::SetSpacing)
//      .def("getSpacingX", &MeshRenderer::GetSpacingX)
//      .def("getSpacingY", &MeshRenderer::GetSpacingY)
//      .def("getSpacingZ", &MeshRenderer::GetSpacingZ)
//      .def("setOrigin", &MeshRenderer::SetOrigin)
//      .def("getOriginX", &MeshRenderer::GetOriginX)
//      .def("getOriginY", &MeshRenderer::GetOriginY)
//      .def("getOriginZ", &MeshRenderer::GetOriginZ)
//      .def("setDisplayStyle", &MeshRenderer::SetDisplayStyle)
//      .def("setObjectSpecificColoring", &MeshRenderer::SetObjectSpecificColoring)
//      .def("updateBoundingBox", &MeshRenderer::UpdateBoundingBox)
  ;
  
//  class_< SSERenderer, bases<Renderer> >("SSERenderer", init<>())
//      .def("draw", &SSERenderer::Draw)
//      .def("drawBoundingBox", &SSERenderer::DrawBoundingBox)
//      .def("loadHelixFile", &SSERenderer::LoadHelixFile)
//      .def("loadSheetFile", &SSERenderer::LoadSheetFile)
//      .def("saveHelixFile", &SSERenderer::SaveHelixFile)
//      .def("saveSheetFile", &SSERenderer::SaveSheetFile)
//      .def("loadGraphSSE", &SSERenderer::LoadGraphSSE)
//      .def("unloadGraphSSEs", &SSERenderer::UnloadGraphSSEs)
//      .def("unload", &SSERenderer::Unload)
//      .def("selectionRotate", &SSERenderer::SelectionRotate)
//      .def("selectionObjectCount", &SSERenderer::SelectionObjectCount)
//      .def("selectionCenterOfMass", &SSERenderer::SelectionCenterOfMass)
//      .def("selectionMove", &SSERenderer::SelectionMove)
//      .def("selectionClear", &SSERenderer::SelectionClear)        
//      .def("selectionToggle", &SSERenderer::SelectionToggle)  
//      .def("getSupportedHelixLoadFileFormats", &SSERenderer::GetSupportedHelixLoadFileFormats)
//      .def("getSupportedHelixSaveFileFormats", &SSERenderer::GetSupportedHelixSaveFileFormats)
//      .def("getSupportedSheetLoadFileFormats", &SSERenderer::GetSupportedSheetLoadFileFormats)
//      .def("getSupportedSheetSaveFileFormats", &SSERenderer::GetSupportedSheetSaveFileFormats)
//      .def("getMin", &SSERenderer::GetMin)
//      .def("getMax", &SSERenderer::GetMax)
//      .def("get3DCoordinates", &SSERenderer::Get3DCoordinates)
//      .def("setHelixColor", &SSERenderer::SetHelixColor)      
//      .def("setSheetColor", &SSERenderer::SetSheetColor)      
//      .def("setSSEColor", &SSERenderer::SetSSEColor)      
//      .def("setSpacing", &SSERenderer::SetSpacing)
//      .def("getSpacingX", &SSERenderer::GetSpacingX)
//      .def("getSpacingY", &SSERenderer::GetSpacingY)
//      .def("getSpacingZ", &SSERenderer::GetSpacingZ)
//      .def("setOrigin", &SSERenderer::SetOrigin)
//      .def("getOriginX", &SSERenderer::GetOriginX)
//      .def("getOriginY", &SSERenderer::GetOriginY)
//      .def("getOriginZ", &SSERenderer::GetOriginZ)
//      .def("fitSelectedSSEs", &SSERenderer::FitSelectedSSEs)      
//      .def("startNewSSE", &SSERenderer::StartNewSSE)
//      .def("addSSEPoint", &SSERenderer::AddSSEPoint)
//      .def("finalizeSheet", &SSERenderer::FinalizeSheet)
//      .def("finalizeHelix", &SSERenderer::FinalizeHelix)
//      .def("addHelix", &SSERenderer::AddHelix)
//      .def("setObjectSpecificColoring", &SSERenderer::SetObjectSpecificColoring)
//      .def("removeSelectedSSEs", &SSERenderer::RemoveSelectedSSEs)
//      .def("removeHelices", &SSERenderer::RemoveHelices)
//      .def("getHelixCount", &SSERenderer::GetHelixCount)
//      .def("getHelixCorner", &SSERenderer::GetHelixCorner)
//      .def("setDisplayStyle", &SSERenderer::SetDisplayStyle)
//      .def("updateBoundingBox", &SSERenderer::UpdateBoundingBox)
//      .def("getSelectedHelixIndices", &SSERenderer::GetSelectedHelixIndices)
//      .def("setSSEOrientationFlips", &SSERenderer::SetSSEOrientationFlips)
//      .def("setHelixCorrs", &SSERenderer::SetHelixCorrs)
//      .def("setSelectedPDBHelices", &SSERenderer::SetSelectedPDBHelices)
//      .def("clearOtherHighlights", &SSERenderer::ClearOtherHighlights)
//  ;
//
//
  class_< CAlphaRenderer, bases<Volume> >("CAlphaRenderer", init<>())
//      .def("draw", &CAlphaRenderer::Draw)
//      .def("drawBoundingBox", &CAlphaRenderer::DrawBoundingBox)
//      .def("loadFile", &CAlphaRenderer::LoadFile)
//      .def("loadSSEHunterFile", &CAlphaRenderer::LoadSSEHunterFile)
      .def("saveSSEHunterFile", &CAlphaRenderer::SaveSSEHunterFile)
////      .def("getSSEHunterAtoms", &CAlphaRenderer::GetSSEHunterAtoms)
//      .def("updateTotalScoreSSEHunterAtoms", &CAlphaRenderer::UpdateTotalScoreSSEHunterAtoms)
//      .def("colorSSEHunterAtoms", &CAlphaRenderer::ColorSSEHunterAtoms)
//      .def("saveFile", &CAlphaRenderer::SaveFile)
//      .def("unload", &CAlphaRenderer::Unload)
//      .def("selectionRotate", &CAlphaRenderer::SelectionRotate)
//      .def("selectionObjectCount", &CAlphaRenderer::SelectionObjectCount)
//      .def("selectionAtomCount", &CAlphaRenderer::SelectionAtomCount)
//      .def("selectionCenterOfMass", &CAlphaRenderer::SelectionCenterOfMass)
//      .def("selectionMove", &CAlphaRenderer::SelectionMove)
//      .def("selectionClear", &CAlphaRenderer::SelectionClear)     
//      .def("selectionToggle", &CAlphaRenderer::SelectionToggle)   
//      .def("getAtomFromHitStack", &CAlphaRenderer::GetAtomFromHitStack, return_value_policy<reference_existing_object>())
//      .def("getSupportedLoadFileFormats", &CAlphaRenderer::GetSupportedLoadFileFormats)
//      .def("getSupportedSaveFileFormats", &CAlphaRenderer::GetSupportedSaveFileFormats)
//      .def("getMin", &CAlphaRenderer::GetMin)
//      .def("getMax", &CAlphaRenderer::GetMax)
//      .def("get3DCoordinates", &CAlphaRenderer::Get3DCoordinates)
      .def("addAtom", &CAlphaRenderer::AddAtom, return_value_policy<reference_existing_object>())
//      .def("getAtom", &CAlphaRenderer::GetAtom, return_value_policy<reference_existing_object>())
//      .def("getSelectedAtom", &CAlphaRenderer::GetSelectedAtom, return_value_policy<reference_existing_object>())
//      .def("getAtomCount", &CAlphaRenderer::GetAtomCount)
//      .def("getAtomHashes", &CAlphaRenderer::GetAtomHashes)
//      .def("deleteAtom", &CAlphaRenderer::DeleteAtom)     
//      .def("addBond", &CAlphaRenderer::AddBond)
//      .def("getBond", &CAlphaRenderer::GetBond, return_value_policy<reference_existing_object>())
//      .def("getBondIndex", &CAlphaRenderer::GetBondIndex)     
//      .def("getBondCount", &CAlphaRenderer::GetBondCount)
//      .def("deleteBond", &CAlphaRenderer::DeleteBond)     
//      .def("addSideChainBond", &CAlphaRenderer::AddSideChainBond)
//      .def("getSideChainBond", &CAlphaRenderer::GetSideChainBond, return_value_policy<reference_existing_object>())
//      .def("getSideChainBondIndex", &CAlphaRenderer::GetSideChainBondIndex)       
//      .def("getSideChainBondCount", &CAlphaRenderer::GetSideChainBondCount)
//      .def("deleteSideChainBond", &CAlphaRenderer::DeleteSideChainBond)       
//      .def("setSpacing", &CAlphaRenderer::SetSpacing)
//      .def("getSpacingX", &CAlphaRenderer::GetSpacingX)
//      .def("getSpacingY", &CAlphaRenderer::GetSpacingY)
//      .def("getSpacingZ", &CAlphaRenderer::GetSpacingZ)
//      .def("setOrigin", &CAlphaRenderer::SetOrigin)
//      .def("getOriginX", &CAlphaRenderer::GetOriginX)
//      .def("getOriginY", &CAlphaRenderer::GetOriginY)
//      .def("getOriginZ", &CAlphaRenderer::GetOriginZ)
//      .def("transformAllAtomLocations", &CAlphaRenderer::TransformAllAtomLocations)       
//      .def("setDisplayStyle", &CAlphaRenderer::SetDisplayStyle)
//      .def("setObjectSpecificColoring", &CAlphaRenderer::SetObjectSpecificColoring)
//      .def("updateBoundingBox", &CAlphaRenderer::UpdateBoundingBox)
//      .def("startHelix", &CAlphaRenderer::StartHelix)
//      .def("addHelixElement", &CAlphaRenderer::AddHelixElement)
//      .def("startStrand", &CAlphaRenderer::StartStrand)
//      .def("addStrandElement", &CAlphaRenderer::AddStrandElement)
//      .def("startLoop", &CAlphaRenderer::StartLoop)
//      .def("addLoopElement", &CAlphaRenderer::AddLoopElement)
//      .def("cleanSecondaryStructures", &CAlphaRenderer::CleanSecondaryStructures)
//      .def("setNumSegments", &CAlphaRenderer::SetNumSegments)
//      .def("setNumSlices", &CAlphaRenderer::SetNumSlices)
//      .def("getSelectedHelixIndices", &CAlphaRenderer::GetSelectedHelixIndices)
//      .def("setHelixCorrs", &CAlphaRenderer::SetHelixCorrs)
//      .def("setSelectedSSEHelices", &CAlphaRenderer::SetSelectedSSEHelices)
//      .def("clearOtherHighlights", &CAlphaRenderer::ClearOtherHighlights)
//      .def("setFeatureVecs", &CAlphaRenderer::SetFeatureVecs)
//      .def("setHelixColor", &CAlphaRenderer::SetHelixColor)
//      .def("startHelix", &CAlphaRenderer::StartHelix)
//      .def("addHelixElement", &CAlphaRenderer::AddHelixElement)
//      .def("startStrand", &CAlphaRenderer::StartStrand)
//      .def("addStrandElement", &CAlphaRenderer::AddStrandElement)
//      .def("startLoop", &CAlphaRenderer::StartLoop)
//      .def("addLoopElement", &CAlphaRenderer::AddLoopElement)
//      .def("cleanSecondaryStructures", &CAlphaRenderer::CleanSecondaryStructures)
//      .def("setNumSegments", &CAlphaRenderer::SetNumSegments)
//      .def("setNumSlices", &CAlphaRenderer::SetNumSlices)
//      .def("setHltRValue", &CAlphaRenderer::SetHltRValue)
//      .def("setHltGValue", &CAlphaRenderer::SetHltGValue)
//      .def("setHltBValue", &CAlphaRenderer::SetHltBValue)
//      .def("setHltAValue", &CAlphaRenderer::SetHltAValue)
  ;
  
  enum_<RadialProfileType>("RadialProfileType")
      .value("gaussian", GAUSSIAN)
      .value("gaussianDip", GAUSSIAN_DIP)
      .value("polynomial", POLYNOMIAL)
      .export_values()
  ;
  
  class_<SSEHunter>("SSEHunter")
      .def("createPseudoAtoms", &SSEHunter::CreatePseudoAtoms)
      .def("getNumberOfPseudoAtoms", &SSEHunter::GetNumberOfPseudoAtoms)
      .def("getPseudoAtom", &SSEHunter::GetPseudoAtom, return_value_policy<reference_existing_object>())
      .def("setCorrelationScores", &SSEHunter::SetCorrelationScores)
      .def("setSkeletonScores", &SSEHunter::SetSkeletonScores)
//      .def("setGeometryScores", &SSEHunter::SetGeometryScores)
      .def("getAtomDistances", &SSEHunter::GetAtomDistances)
//      .def("getNeighborhoodVoxels", &SSEHunter::GetNeighborhoodVoxels)
      .def("getLocalDirectionalityScores", &SSEHunter::GetLocalDirectionalityScores)
  ;

  class_<PDBAtom>("PDBAtom", init<string, char, unsigned int, string>())
//        .def("getPDBId", &PDBAtom::GetPDBId)
        .def("getSerial", &PDBAtom::GetSerial)
//        .def("getName", &PDBAtom::GetName)
//        .def("getAltLoc", &PDBAtom::GetAltLoc)
//        .def("getResName", &PDBAtom::GetResName)
//        .def("getChainId", &PDBAtom::GetChainId)
//        .def("getResSeq", &PDBAtom::GetResSeq)
//        .def("getICode", &PDBAtom::GetICode)
        .def("getPosition", &PDBAtom::GetPosition)
//        .def("getOccupancy", &PDBAtom::GetOccupancy)
//        .def("getTempFactor", &PDBAtom::GetTempFactor)
//        .def("getElement", &PDBAtom::GetElement)
//        .def("getCharge", &PDBAtom::GetCharge)
//        .def("getAtomRadius", &PDBAtom::GetAtomRadius)
//        .def("getColorA", &PDBAtom::GetColorA)
//        .def("getColorR", &PDBAtom::GetColorR)
//        .def("getColorG", &PDBAtom::GetColorG)
//        .def("getColorB", &PDBAtom::GetColorB)
//        .def("getSelected", &PDBAtom::GetSelected)
        .def("getCorrelationScore", &PDBAtom::GetCorrelationScore)
        .def("getSkeletonScore", &PDBAtom::GetSkeletonScore)
        .def("getGeometryScore", &PDBAtom::GetGeometryScore)
//        .def("getHashKey", &PDBAtom::GetHashKey)
//        .def("getVisible", &PDBAtom::GetVisible)
//        .def("constructHashKey", &PDBAtom::ConstructHashKey)
//        .def("setSerial", &PDBAtom::SetSerial)
//        .def("setName", &PDBAtom::SetName)
//        .def("setAltLoc", &PDBAtom::SetAltLoc)
//        .def("setResName", &PDBAtom::SetResName)
//        .def("setChainId", &PDBAtom::SetChainId)
//        .def("setResSeq", &PDBAtom::SetResSeq)
//        .def("setICode", &PDBAtom::SetICode)
//        .def("setPosition", &PDBAtom::SetPosition)
//        .def("setOccupancy", &PDBAtom::SetOccupancy)
        .def("setTempFactor", &PDBAtom::SetTempFactor)
//        .def("setElement", &PDBAtom::SetElement)
//        .def("setCharge", &PDBAtom::SetCharge)
//        .def("setAtomRadius", &PDBAtom::SetAtomRadius)
//        .def("setColor", &PDBAtom::SetColor)
//        .def("setSelected", &PDBAtom::SetSelected)
//        .def("setVisible", &PDBAtom::SetVisible)
//        .def("setCorrelationScore", &PDBAtom::SetCorrelationScore)
//        .def("setSkeletonScore", &PDBAtom::SetSkeletonScore)
        .def("setGeometryScore", &PDBAtom::SetGeometryScore)
//        .def("transform", &PDBAtom::Transform)
//        .def("interpolateTransform", &PDBAtom::InterpolateTransform)
//        .def("getInterpolateTransformLocation", &PDBAtom::GetInterpolateTransformLocation)
//        .def("setPrevCAHash", &PDBAtom::SetPrevCAHash)
//        .def("setNextCAHash", &PDBAtom::SetNextCAHash)
    ;

  class_<Vector3DFloat>("Vector3DFloat", init<float, float, float>())
        .def("x", &Vector3DFloat::X)
        .def("y", &Vector3DFloat::Y)
        .def("z", &Vector3DFloat::Z)
        .def("length", &Vector3DFloat::Length)
        .def("Transform", &Vector3DFloat::Transform)
        .def("rotate", &Vector3DFloat::Rotate)
        .def("Print", &Vector3DFloat::Print)
        .def(self * double())
        .def(self + self)
        .def(self - self)
        .def(self ^ self)
        .def(self += self)
        .def(self -= self)
        //Vector3DTemplate<T> operator-();
        //Vector3DTemplate<T>& operator=(const Vector3DTemplate<T>& d);

    ;

}
